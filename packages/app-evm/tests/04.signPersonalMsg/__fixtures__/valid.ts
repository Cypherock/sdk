import { hexToUint8Array, createFlowStatus } from '@cypherock/sdk-utils';
import { ISignPersonalMsgTestCase } from './types';
import { SignMsgType } from '../../../src';
import { queryToUint8Array, resultToUint8Array } from '../__helpers__';

const withSmallMsg: ISignPersonalMsgTestCase = {
  name: 'With small msg',
  params: {
    walletId: new Uint8Array([
      199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103, 233, 62,
      110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128, 26, 3, 187, 121,
      64,
    ]),
    derivationPath: [0x80000000 + 44, 0x80000000 + 60, 0x80000000, 0, 0],
    message:
      '0x74657374696e67207465787420666f72207369676e696e6720706572736f6e616c206d657373616765',
  },
  queries: [
    {
      name: 'Initate query',
      data: queryToUint8Array({
        signMsg: {
          initiate: {
            walletId: new Uint8Array([
              199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103,
              233, 62, 110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128,
              26, 3, 187, 121, 64,
            ]),
            derivationPath: [
              0x80000000 + 44,
              0x80000000 + 60,
              0x80000000,
              0,
              0,
            ],
            messageType: SignMsgType.SIGN_MSG_TYPE_PERSONAL_SIGN,
            totalMsgSize: 41,
          },
        },
      }),
    },
    {
      name: 'Msg data chunk payload',
      data: queryToUint8Array({
        signMsg: {
          msgData: {
            chunkPayload: {
              chunk: hexToUint8Array(
                '0x74657374696e67207465787420666f72207369676e696e6720706572736f6e616c206d657373616765',
              ),
              chunkIndex: 0,
              totalChunks: 1,
              remainingSize: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Msg signature request',
      data: queryToUint8Array({
        signMsg: {
          signature: {},
        },
      }),
    },
  ],
  results: [
    {
      name: 'Msg initiate confirmation',
      data: resultToUint8Array({
        signMsg: {
          confirmation: {},
        },
      }),
      statuses: [
        {
          flowStatus: createFlowStatus(0, 0),
          expectEventCalls: [0],
        },
        {
          flowStatus: createFlowStatus(1, 0),
          expectEventCalls: [1],
        },
      ],
    },
    {
      name: 'Msg data chunk ack',
      data: resultToUint8Array({
        signMsg: {
          dataAccepted: {
            chunkAck: {
              chunkIndex: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Signature',
      data: resultToUint8Array({
        signMsg: {
          signature: {
            r: hexToUint8Array(
              '0xf891cb3f97d011391f24ba4815731306b0eb7b2b656bb7fa119257c2d36166bf',
            ),
            s: hexToUint8Array(
              '0x1b3944d396f30bf85338ef1e81cb6740924946a46e35370a8b930109a23c9269',
            ),
            v: hexToUint8Array('0x26'),
          },
        },
      }),
    },
  ],
  mocks: { eventCalls: [[0], [1], [2], [3], [4]] },
  output: {
    signature: {
      r: '0xf891cb3f97d011391f24ba4815731306b0eb7b2b656bb7fa119257c2d36166bf',
      s: '0x1b3944d396f30bf85338ef1e81cb6740924946a46e35370a8b930109a23c9269',
      v: '0x26',
    },
    serializedSignature:
      '0xf891cb3f97d011391f24ba4815731306b0eb7b2b656bb7fa119257c2d36166bf1b3944d396f30bf85338ef1e81cb6740924946a46e35370a8b930109a23c92691c',
  },
};

const withLargeMsg: ISignPersonalMsgTestCase = {
  name: 'With large msg',
  params: {
    walletId: new Uint8Array([
      199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103, 233, 62,
      110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128, 26, 3, 187, 121,
      64,
    ]),
    derivationPath: [0x80000000 + 44, 0x80000000 + 60, 0x80000000, 0, 0],
    message:
      '4c6f72656d20697073756d20646f6c6f722073697420616d65742c20636f6e73656374657475722061646970697363696e6720656c69742c2073656420646f20656975736d6f642074656d706f7220696e6369646964756e74207574206c61626f726520657420646f6c6f7265206d61676e6120616c697175612e2056697665727261206e69626820637261732070756c76696e6172206d61747469732e20446f6c6f722073697420616d657420636f6e73656374657475722061646970697363696e6720656c69742064756973207472697374697175652e204d616c657375616461206e756e632076656c20726973757320636f6d6d6f646f2076697665727261206d616563656e617320616363756d73616e206c616375732076656c2e204e6571756520766f6c75747061742061632074696e636964756e742076697461652073656d70657220717569732e20566f6c7574706174207365642063726173206f726e61726520617263752064756920766976616d757320617263752e2053656d206672696e67696c6c61207574206d6f7262692074696e636964756e7420617567756520696e74657264756d2076656c69742e2056656e656e61746973206120636f6e64696d656e74756d2076697461652073617069656e2070656c6c656e746573717565206861626974616e742e20436f6e73656374657475722061646970697363696e6720656c697420647569732074726973746971756520736f6c6c696369747564696e2e20556c747269636573206d692074656d70757320696d70657264696574206e756c6c61206d616c6573756164612070656c6c656e74657371756520656c697420656765742e20426962656e64756d20656e696d20666163696c697369732067726176696461206e6571756520636f6e76616c6c69732e20496e206e696268206d617572697320637572737573206d6174746973206d6f6c65737469652e204120636f6e64696d656e74756d2076697461652073617069656e2070656c6c656e746573717565206861626974616e74206d6f726269207472697374697175652073656e65637475732065742e204f7263692070686173656c6c757320656765737461732074656c6c75732072757472756d2074656c6c75732070656c6c656e7465737175652065752e204f726e61726520617263752064756920766976616d757320617263752066656c697320626962656e64756d2e20456c6974207365642076756c707574617465206d692073697420616d6574206d617572697320636f6d6d6f646f207175697320696d706572646965742e204163207475727069732065676573746173206d616563656e617320706861726574726120636f6e76616c6c69732e205669766572726120766974616520636f6e67756520657520636f6e7365717561742061632066656c697320646f6e6563206574206f64696f2e20536f64616c65732075742065752073656d20696e7465676572207669746165206a7573746f2065676574206d61676e612e2041646970697363696e6720626962656e64756d2065737420756c7472696369657320696e746567657220717569732e0a0a56756c707574617465206469676e697373696d2073757370656e646973736520696e2065737420616e746520696e206e6962682e20457520766f6c7574706174206f64696f20666163696c69736973206d61757269732073697420616d6574206d617373612076697461652e2041726375206f64696f2075742073656d206e756c6c61207068617265747261206469616d2e204469616d20696e20617263752063757273757320657569736d6f6420717569732076697665727261206e69626820637261732e20426962656e64756d2075742074726973746971756520657420656765737461732e20412070656c6c656e7465737175652073697420616d657420706f72747469746f72206567657420646f6c6f72206d6f726269206e6f6e2e204475697320636f6e76616c6c697320636f6e76616c6c69732074656c6c757320696420696e74657264756d2076656c69742e205472697374697175652065742065676573746173207175697320697073756d2e20416e746520696e206e696268206d617572697320637572737573206d6174746973206d6f6c65737469652e2053656420726973757320756c7472696369657320747269737469717565206e756c6c6120616c69717565742e0a0a4d617373612073617069656e206661756369627573206574206d6f6c65737469652061632e20536564206f64696f206d6f726269207175697320636f6d6d6f646f206f64696f2e20436f6e7365717561742061632066656c697320646f6e6563206574206f64696f2070656c6c656e7465737175652e20546f72746f7220616c697175616d206e756c6c6120666163696c6973692063726173206665726d656e74756d206f64696f2e205175616d206964206c656f20696e20766974616520747572706973206d61737361207365642e204e756e63206d6920697073756d20666175636962757320766974616520616c69717565742e204c616f726565742073757370656e646973736520696e74657264756d20636f6e7365637465747572206c696265726f206964206661756369627573206e69736c2e2049642076656e656e61746973206120636f6e64696d656e74756d2076697461652e204c616f726565742073697420616d6574206375727375732073697420616d65742064696374756d2e204d61747469732070656c6c656e746573717565206964206e69626820746f72746f722e20416d657420616c697175616d206964206469616d206d616563656e617320756c74726963696573206d692065676574206d61757269732070686172657472612e204d6574757320616c697175616d20656c656966656e64206d6920696e206e756c6c6120706f737565726520736f6c6c696369747564696e2e0a0a496e206e696268206d617572697320637572737573206d6174746973206d6f6c657374696520612e20496e2064696374756d206e6f6e20636f6e7365637465747572206120657261742e2053656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732065676573746173206d616563656e61732e2053656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732e204574206e65747573206574206d616c6573756164612066616d6573206163207475727069732065676573746173206d616563656e61732e204c61637573207669766572726120766974616520636f6e67756520657520636f6e7365717561742e204567657420647569732061742074656c6c75732061742075726e6120636f6e64696d656e74756d2e204d6174746973206d6f6c6573746965206120696163756c697320617420657261742070656c6c656e7465737175652061646970697363696e6720636f6d6d6f646f2e2053656d7065722071756973206c6563747573206e756c6c6120617420766f6c75747061742e205472697374697175652073656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732e204d692073697420616d6574206d617572697320636f6d6d6f646f207175697320696d70657264696574206d617373612074696e636964756e74206e756e632e205269737573206e756c6c616d20656765742066656c69732065676574206e756e63206c6f626f72746973206d617474697320616c697175616d2066617563696275732e204e756e632070756c76696e61722073617069656e206574206c6967756c6120756c6c616d636f727065722e204c696265726f20656e696d207365642066617563696275732074757270697320696e206575206d6920626962656e64756d206e657175652e2056656c6974206469676e697373696d20736f64616c65732075742065752073656d20696e74656765722076697461652e204469676e697373696d2073757370656e646973736520696e2065737420616e74652e0a0a4e6f6e20656e696d207072616573656e7420656c656d656e74756d20666163696c69736973206c656f2076656c206672696e67696c6c612065737420756c6c616d636f727065722e204d617373612074696e636964756e7420647569207574206f726e617265206c65637475732073697420616d65742065737420706c6163657261742e2041646970697363696e6720747269737469717565207269737573206e6563206665756769617420696e206665726d656e74756d20706f73756572652075726e61206e65632e204c61637573206c756374757320616363756d73616e20746f72746f7220706f737565726520616320757420636f6e7365717561742073656d70657220766976657272612e20556c6c616d636f727065722076656c69742073656420756c6c616d636f72706572206d6f7262692074696e636964756e74206f726e617265206d6173736120656765742e204f726369206e756c6c612070656c6c656e746573717565206469676e697373696d20656e696d2073697420616d65742076656e656e617469732075726e61206375727375732e20496e2064696374756d206e6f6e20636f6e736563746574757220612065726174206e616d2061742e204d61676e61206567657420657374206c6f72656d20697073756d20646f6c6f722e2044696374756d20667573636520757420706c616365726174206f726369206e756c6c612070656c6c656e746573717565206469676e697373696d20656e696d207369742e2056656c206f72636920706f727461206e6f6e2070756c76696e61722e20496e746567657220656e696d206e6571756520766f6c75747061742061632e2041646970697363696e6720626962656e64756d2065737420756c7472696369657320696e7465676572207175697320617563746f7220656c6974207365642076756c7075746174652e20496e206861632068616269746173736520706c617465612064696374756d737420717569737175652073616769747469732070757275732073697420616d65742e20566974616520636f6e677565206d61757269732072686f6e6375732061656e65616e2076656c20656c6974207363656c65726973717565206d61757269732e0a0a4c6163757320766573746962756c756d207365642061726375206e6f6e206f64696f20657569736d6f64206c6163696e69612e204d6f726269207472697374697175652073656e6563747573206574206e65747573206574206d616c6573756164612e20557420656e696d20626c616e64697420766f6c7574706174206d616563656e617320766f6c757470617420626c616e64697420616c697175616d20657469616d20657261742e2041646970697363696e67206469616d20646f6e65632061646970697363696e6720747269737469717565207269737573206e6563206665756769617420696e206665726d656e74756d2e20456c6974207363656c65726973717565206d61757269732070656c6c656e7465737175652070756c76696e61722070656c6c656e746573717565206861626974616e74206d6f726269207472697374697175652073656e65637475732e20416c697175616d206e756c6c6120666163696c6973692063726173206665726d656e74756d206f64696f20657520666575676961742e20566f6c7574706174207365642063726173206f726e6172652061726375206475692e20556c74726963696573206c6163757320736564207475727069732074696e636964756e742069642e204d617373612073617069656e206661756369627573206574206d6f6c6573746965206163206665756769617420736564206c656374757320766573746962756c756d2e2054656c6c757320696e206d657475732076756c707574617465206575207363656c657269737175652066656c69732e2054656d707573207175616d2070656c6c656e746573717565206e6563206e616d20616c697175616d2e204e696268207072616573656e7420747269737469717565206d61676e612073697420616d65742070757275732e2056697665727261206d617572697320696e20616c697175616d2073656d206672696e67696c6c61207574206d6f7262692074696e636964756e742061756775652e204174206175677565206567657420617263752064696374756d2e2046757363652069642076656c697420757420746f72746f722e204469616d2076756c7075746174652075742070686172657472612073697420616d657420616c697175616d206964206469616d206d616563656e61732e20496e206575206d6920626962656e64756d206e65717565206567657374617320636f6e677565207175697371756520656765737461732e0a0a46656c697320626962656e64756d207574207472697374697175652065742e2053656d206672696e67696c6c61207574206d6f7262692074696e636964756e742e204772617669646120696e206665726d656e74756d20657420736f6c6c696369747564696e2e20496e74657264756d20706f7375657265206c6f72656d20697073756d20646f6c6f72207369742e204e69736c2072686f6e637573206d61747469732072686f6e6375732075726e61206e657175652076697665727261206a7573746f206e65632e2041646970697363696e6720656e696d206575207475727069732065676573746173207072657469756d2061656e65616e2e2044756973207574206469616d207175616d206e756c6c6120706f72747469746f72206d617373612069642e204d616c6573756164612066616d6573206163207475727069732065676573746173207365642074656d7075732075726e612e20556c7472696365732065726f7320696e2063757273757320747572706973206d617373612074696e636964756e74206475692e20557420616c697175616d2070757275732073697420616d6574206c75637475732076656e656e61746973206c65637475732e2054656c6c7573206d61757269732061206469616d206d616563656e61732e2053757363697069742074656c6c7573206d61757269732061206469616d206d616563656e6173207365642e204e756e632070756c76696e61722073617069656e206574206c6967756c6120756c6c616d636f72706572206d616c6573756164612070726f696e206c696265726f206e756e632e20506f7375657265206d6f726269206c656f2075726e61206d6f6c65737469652061742e2056656c697420657569736d6f6420696e2070656c6c656e746573717565206d6173736120706c61636572617420647569732e0a0a53656d70657220726973757320696e2068656e64726572697420677261766964612072757472756d2071756973717565206e6f6e2e20506f73756572652075726e61206e65632074696e636964756e74207072616573656e742e2053697420616d657420636f6e73656374657475722061646970697363696e6720656c697420647569732074726973746971756520736f6c6c696369747564696e206e6962682e20536167697474697320696420636f6e73656374657475722070757275732075742066617563696275732070756c76696e617220656c656d656e74756d20696e746567657220656e696d2e2053656420766976657272612074656c6c757320696e20686163206861626974617373652e20456c656d656e74756d20696e746567657220656e696d206e6571756520766f6c75747061742e20566573746962756c756d206d617474697320756c6c616d636f727065722076656c69742073656420756c6c616d636f72706572206d6f7262692074696e636964756e74206f726e617265206d617373612e204475697320617420636f6e7365637465747572206c6f72656d20646f6e65632e204e69626820746f72746f7220696420616c6971756574206c65637475732070726f696e206e696268206e69736c20636f6e64696d656e74756d2069642e204f726e6172652061656e65616e20657569736d6f6420656c656d656e74756d206e6973692e204e6f6e20656e696d207072616573656e7420656c656d656e74756d20666163696c69736973206c656f2e204573742070656c6c656e74657371756520656c697420756c6c616d636f72706572206469676e697373696d20637261732e',
  },
  queries: [
    {
      name: 'Initate query',
      data: queryToUint8Array({
        signMsg: {
          initiate: {
            walletId: new Uint8Array([
              199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103,
              233, 62, 110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128,
              26, 3, 187, 121, 64,
            ]),
            derivationPath: [
              0x80000000 + 44,
              0x80000000 + 60,
              0x80000000,
              0,
              0,
            ],
            messageType: SignMsgType.SIGN_MSG_TYPE_PERSONAL_SIGN,
            totalMsgSize: 6019,
          },
        },
      }),
    },
    {
      name: 'Msg data chunk payload 1',
      data: queryToUint8Array({
        signMsg: {
          msgData: {
            chunkPayload: {
              chunk: hexToUint8Array(
                '0x4c6f72656d20697073756d20646f6c6f722073697420616d65742c20636f6e73656374657475722061646970697363696e6720656c69742c2073656420646f20656975736d6f642074656d706f7220696e6369646964756e74207574206c61626f726520657420646f6c6f7265206d61676e6120616c697175612e2056697665727261206e69626820637261732070756c76696e6172206d61747469732e20446f6c6f722073697420616d657420636f6e73656374657475722061646970697363696e6720656c69742064756973207472697374697175652e204d616c657375616461206e756e632076656c20726973757320636f6d6d6f646f2076697665727261206d616563656e617320616363756d73616e206c616375732076656c2e204e6571756520766f6c75747061742061632074696e636964756e742076697461652073656d70657220717569732e20566f6c7574706174207365642063726173206f726e61726520617263752064756920766976616d757320617263752e2053656d206672696e67696c6c61207574206d6f7262692074696e636964756e7420617567756520696e74657264756d2076656c69742e2056656e656e61746973206120636f6e64696d656e74756d2076697461652073617069656e2070656c6c656e746573717565206861626974616e742e20436f6e73656374657475722061646970697363696e6720656c697420647569732074726973746971756520736f6c6c696369747564696e2e20556c747269636573206d692074656d70757320696d70657264696574206e756c6c61206d616c6573756164612070656c6c656e74657371756520656c697420656765742e20426962656e64756d20656e696d20666163696c697369732067726176696461206e6571756520636f6e76616c6c69732e20496e206e696268206d617572697320637572737573206d6174746973206d6f6c65737469652e204120636f6e64696d656e74756d2076697461652073617069656e2070656c6c656e746573717565206861626974616e74206d6f726269207472697374697175652073656e65637475732065742e204f7263692070686173656c6c757320656765737461732074656c6c75732072757472756d2074656c6c75732070656c6c656e7465737175652065752e204f726e61726520617263752064756920766976616d757320617263752066656c697320626962656e64756d2e20456c6974207365642076756c707574617465206d692073697420616d6574206d617572697320636f6d6d6f646f207175697320696d706572646965742e204163207475727069732065676573746173206d616563656e617320706861726574726120636f6e76616c6c69732e205669766572726120766974616520636f6e67756520657520636f6e7365717561742061632066656c697320646f6e6563206574206f64696f2e20536f64616c65732075742065752073656d20696e7465676572207669746165206a7573746f2065676574206d61676e612e2041646970697363696e6720626962656e64756d2065737420756c7472696369657320696e746567657220717569732e0a0a56756c707574617465206469676e697373696d2073757370656e646973736520696e2065737420616e746520696e206e6962682e20457520766f6c7574706174206f64696f20666163696c69736973206d61757269732073697420616d6574206d617373612076697461652e2041726375206f64696f2075742073656d206e756c6c61207068617265747261206469616d2e204469616d20696e20617263752063757273757320657569736d6f6420717569732076697665727261206e69626820637261732e20426962656e64756d2075742074726973746971756520657420656765737461732e20412070656c6c656e7465737175652073697420616d657420706f72747469746f72206567657420646f6c6f72206d6f726269206e6f6e2e204475697320636f6e76616c6c697320636f6e76616c6c69732074656c6c757320696420696e74657264756d2076656c69742e205472697374697175652065742065676573746173207175697320697073756d2e20416e746520696e206e696268206d617572697320637572737573206d6174746973206d6f6c65737469652e2053656420726973757320756c7472696369657320747269737469717565206e756c6c6120616c69717565742e0a0a4d617373612073617069656e206661756369627573206574206d6f6c65737469652061632e20536564206f64696f206d6f726269207175697320636f6d6d6f646f206f64696f2e20436f6e7365717561742061632066656c697320646f6e6563206574206f64696f2070656c6c656e7465737175652e20546f72746f7220616c697175616d206e756c6c6120666163696c6973692063726173206665726d656e74756d206f64696f2e205175616d206964206c656f20696e20766974616520747572706973206d61737361207365642e204e756e63206d6920697073756d20666175636962757320766974616520616c69717565742e204c616f726565742073757370656e646973736520696e74657264756d20636f6e7365637465747572206c696265726f206964206661756369627573206e69736c2e2049642076656e656e61746973206120636f6e64696d656e74756d2076697461652e204c616f726565742073697420616d6574206375727375732073697420616d65742064696374756d2e204d61747469732070656c6c656e746573717565206964206e69626820746f72746f722e',
              ),
              chunkIndex: 0,
              totalChunks: 3,
              remainingSize: 6019 - 2048,
            },
          },
        },
      }),
    },
    {
      name: 'Msg data chunk payload 2',
      data: queryToUint8Array({
        signMsg: {
          msgData: {
            chunkPayload: {
              chunk: hexToUint8Array(
                '0x20416d657420616c697175616d206964206469616d206d616563656e617320756c74726963696573206d692065676574206d61757269732070686172657472612e204d6574757320616c697175616d20656c656966656e64206d6920696e206e756c6c6120706f737565726520736f6c6c696369747564696e2e0a0a496e206e696268206d617572697320637572737573206d6174746973206d6f6c657374696520612e20496e2064696374756d206e6f6e20636f6e7365637465747572206120657261742e2053656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732065676573746173206d616563656e61732e2053656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732e204574206e65747573206574206d616c6573756164612066616d6573206163207475727069732065676573746173206d616563656e61732e204c61637573207669766572726120766974616520636f6e67756520657520636f6e7365717561742e204567657420647569732061742074656c6c75732061742075726e6120636f6e64696d656e74756d2e204d6174746973206d6f6c6573746965206120696163756c697320617420657261742070656c6c656e7465737175652061646970697363696e6720636f6d6d6f646f2e2053656d7065722071756973206c6563747573206e756c6c6120617420766f6c75747061742e205472697374697175652073656e6563747573206574206e65747573206574206d616c6573756164612066616d6573206163207475727069732e204d692073697420616d6574206d617572697320636f6d6d6f646f207175697320696d70657264696574206d617373612074696e636964756e74206e756e632e205269737573206e756c6c616d20656765742066656c69732065676574206e756e63206c6f626f72746973206d617474697320616c697175616d2066617563696275732e204e756e632070756c76696e61722073617069656e206574206c6967756c6120756c6c616d636f727065722e204c696265726f20656e696d207365642066617563696275732074757270697320696e206575206d6920626962656e64756d206e657175652e2056656c6974206469676e697373696d20736f64616c65732075742065752073656d20696e74656765722076697461652e204469676e697373696d2073757370656e646973736520696e2065737420616e74652e0a0a4e6f6e20656e696d207072616573656e7420656c656d656e74756d20666163696c69736973206c656f2076656c206672696e67696c6c612065737420756c6c616d636f727065722e204d617373612074696e636964756e7420647569207574206f726e617265206c65637475732073697420616d65742065737420706c6163657261742e2041646970697363696e6720747269737469717565207269737573206e6563206665756769617420696e206665726d656e74756d20706f73756572652075726e61206e65632e204c61637573206c756374757320616363756d73616e20746f72746f7220706f737565726520616320757420636f6e7365717561742073656d70657220766976657272612e20556c6c616d636f727065722076656c69742073656420756c6c616d636f72706572206d6f7262692074696e636964756e74206f726e617265206d6173736120656765742e204f726369206e756c6c612070656c6c656e746573717565206469676e697373696d20656e696d2073697420616d65742076656e656e617469732075726e61206375727375732e20496e2064696374756d206e6f6e20636f6e736563746574757220612065726174206e616d2061742e204d61676e61206567657420657374206c6f72656d20697073756d20646f6c6f722e2044696374756d20667573636520757420706c616365726174206f726369206e756c6c612070656c6c656e746573717565206469676e697373696d20656e696d207369742e2056656c206f72636920706f727461206e6f6e2070756c76696e61722e20496e746567657220656e696d206e6571756520766f6c75747061742061632e2041646970697363696e6720626962656e64756d2065737420756c7472696369657320696e7465676572207175697320617563746f7220656c6974207365642076756c7075746174652e20496e206861632068616269746173736520706c617465612064696374756d737420717569737175652073616769747469732070757275732073697420616d65742e20566974616520636f6e677565206d61757269732072686f6e6375732061656e65616e2076656c20656c6974207363656c65726973717565206d61757269732e0a0a4c6163757320766573746962756c756d207365642061726375206e6f6e206f64696f20657569736d6f64206c6163696e69612e204d6f726269207472697374697175652073656e6563747573206574206e65747573206574206d616c6573756164612e20557420656e696d20626c616e64697420766f6c7574706174206d616563656e617320766f6c757470617420626c616e64697420616c697175616d20657469616d20657261742e2041646970697363696e67206469616d20646f6e65632061646970697363696e6720747269737469717565207269737573206e6563206665756769617420696e206665726d656e74756d2e20456c6974207363656c65726973717565206d61757269732070656c6c656e7465737175652070756c76696e61722070656c',
              ),
              chunkIndex: 1,
              totalChunks: 3,
              remainingSize: 6019 - 2048 * 2,
            },
          },
        },
      }),
    },
    {
      name: 'Msg data chunk payload 3',
      data: queryToUint8Array({
        signMsg: {
          msgData: {
            chunkPayload: {
              chunk: hexToUint8Array(
                '0x6c656e746573717565206861626974616e74206d6f726269207472697374697175652073656e65637475732e20416c697175616d206e756c6c6120666163696c6973692063726173206665726d656e74756d206f64696f20657520666575676961742e20566f6c7574706174207365642063726173206f726e6172652061726375206475692e20556c74726963696573206c6163757320736564207475727069732074696e636964756e742069642e204d617373612073617069656e206661756369627573206574206d6f6c6573746965206163206665756769617420736564206c656374757320766573746962756c756d2e2054656c6c757320696e206d657475732076756c707574617465206575207363656c657269737175652066656c69732e2054656d707573207175616d2070656c6c656e746573717565206e6563206e616d20616c697175616d2e204e696268207072616573656e7420747269737469717565206d61676e612073697420616d65742070757275732e2056697665727261206d617572697320696e20616c697175616d2073656d206672696e67696c6c61207574206d6f7262692074696e636964756e742061756775652e204174206175677565206567657420617263752064696374756d2e2046757363652069642076656c697420757420746f72746f722e204469616d2076756c7075746174652075742070686172657472612073697420616d657420616c697175616d206964206469616d206d616563656e61732e20496e206575206d6920626962656e64756d206e65717565206567657374617320636f6e677565207175697371756520656765737461732e0a0a46656c697320626962656e64756d207574207472697374697175652065742e2053656d206672696e67696c6c61207574206d6f7262692074696e636964756e742e204772617669646120696e206665726d656e74756d20657420736f6c6c696369747564696e2e20496e74657264756d20706f7375657265206c6f72656d20697073756d20646f6c6f72207369742e204e69736c2072686f6e637573206d61747469732072686f6e6375732075726e61206e657175652076697665727261206a7573746f206e65632e2041646970697363696e6720656e696d206575207475727069732065676573746173207072657469756d2061656e65616e2e2044756973207574206469616d207175616d206e756c6c6120706f72747469746f72206d617373612069642e204d616c6573756164612066616d6573206163207475727069732065676573746173207365642074656d7075732075726e612e20556c7472696365732065726f7320696e2063757273757320747572706973206d617373612074696e636964756e74206475692e20557420616c697175616d2070757275732073697420616d6574206c75637475732076656e656e61746973206c65637475732e2054656c6c7573206d61757269732061206469616d206d616563656e61732e2053757363697069742074656c6c7573206d61757269732061206469616d206d616563656e6173207365642e204e756e632070756c76696e61722073617069656e206574206c6967756c6120756c6c616d636f72706572206d616c6573756164612070726f696e206c696265726f206e756e632e20506f7375657265206d6f726269206c656f2075726e61206d6f6c65737469652061742e2056656c697420657569736d6f6420696e2070656c6c656e746573717565206d6173736120706c61636572617420647569732e0a0a53656d70657220726973757320696e2068656e64726572697420677261766964612072757472756d2071756973717565206e6f6e2e20506f73756572652075726e61206e65632074696e636964756e74207072616573656e742e2053697420616d657420636f6e73656374657475722061646970697363696e6720656c697420647569732074726973746971756520736f6c6c696369747564696e206e6962682e20536167697474697320696420636f6e73656374657475722070757275732075742066617563696275732070756c76696e617220656c656d656e74756d20696e746567657220656e696d2e2053656420766976657272612074656c6c757320696e20686163206861626974617373652e20456c656d656e74756d20696e746567657220656e696d206e6571756520766f6c75747061742e20566573746962756c756d206d617474697320756c6c616d636f727065722076656c69742073656420756c6c616d636f72706572206d6f7262692074696e636964756e74206f726e617265206d617373612e204475697320617420636f6e7365637465747572206c6f72656d20646f6e65632e204e69626820746f72746f7220696420616c6971756574206c65637475732070726f696e206e696268206e69736c20636f6e64696d656e74756d2069642e204f726e6172652061656e65616e20657569736d6f6420656c656d656e74756d206e6973692e204e6f6e20656e696d207072616573656e7420656c656d656e74756d20666163696c69736973206c656f2e204573742070656c6c656e74657371756520656c697420756c6c616d636f72706572206469676e697373696d20637261732e',
              ),
              chunkIndex: 2,
              totalChunks: 3,
              remainingSize: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Msg signature request',
      data: queryToUint8Array({
        signMsg: {
          signature: {},
        },
      }),
    },
  ],
  results: [
    {
      name: 'Msg data confirmation',
      data: resultToUint8Array({
        signMsg: {
          confirmation: {},
        },
      }),
      statuses: [
        {
          flowStatus: createFlowStatus(0, 0),
          expectEventCalls: [0],
        },
        {
          flowStatus: createFlowStatus(1, 0),
          expectEventCalls: [1],
        },
      ],
    },
    {
      name: 'Msg data chunk ack 1',
      data: resultToUint8Array({
        signMsg: {
          dataAccepted: {
            chunkAck: {
              chunkIndex: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Msg data chunk ack 2',
      data: resultToUint8Array({
        signMsg: {
          dataAccepted: {
            chunkAck: {
              chunkIndex: 1,
            },
          },
        },
      }),
    },
    {
      name: 'Msg data chunk ack 3',
      data: resultToUint8Array({
        signMsg: {
          dataAccepted: {
            chunkAck: {
              chunkIndex: 2,
            },
          },
        },
      }),
    },
    {
      name: 'Signature',
      data: resultToUint8Array({
        signMsg: {
          signature: {
            r: hexToUint8Array(
              '0xa39e9ff12916bdaa7ba5c55bb5dcfe1d26f6f20e6ee18f60b4bee6cf099830cb',
            ),
            s: hexToUint8Array(
              '0x539ebd86f6ed10a2cacb5960e23cc894d6c8f23244b09e96c7a88624ee8a7c93',
            ),
            v: hexToUint8Array('0x00'),
          },
        },
      }),
    },
  ],
  mocks: { eventCalls: [[0], [1], [2], [3], [4]] },
  output: {
    signature: {
      r: '0xa39e9ff12916bdaa7ba5c55bb5dcfe1d26f6f20e6ee18f60b4bee6cf099830cb',
      s: '0x539ebd86f6ed10a2cacb5960e23cc894d6c8f23244b09e96c7a88624ee8a7c93',
      v: '0x00',
    },
    serializedSignature:
      '0xa39e9ff12916bdaa7ba5c55bb5dcfe1d26f6f20e6ee18f60b4bee6cf099830cb539ebd86f6ed10a2cacb5960e23cc894d6c8f23244b09e96c7a88624ee8a7c931b',
  },
};

const valid: ISignPersonalMsgTestCase[] = [withSmallMsg, withLargeMsg];

export default valid;
