import { hexToUint8Array, createFlowStatus } from '@cypherock/sdk-utils';
import { ISignTxnTestCase } from './types';
import { queryToUint8Array, resultToUint8Array } from '../__helpers__';

const withOneInput: ISignTxnTestCase = {
  name: 'With 1 input',
  params: {
    walletId: new Uint8Array([
      199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103, 233, 62,
      110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128, 26, 3, 187, 121,
      64,
    ]),
    derivationPath: [0x80000000 + 44, 0x80000000, 0x80000000],
    txn: {
      inputs: [
        {
          prevIndex: 0,
          prevTxnId:
            'e1483376a1cd64027f386c2e28650536a13c813e955469f1f486dafb4f4b861d',
          prevTxn:
            '0200000002e5937831604534dfe013f9a6a983ae6d6bd853f42f235ce70ca5a7fe81643738000000006b483045022100ced63a4d44463475dacc752dc0a6f67b892eb4894ec99117c9fb04ac03b05bae022036c9985920b9d838858082223eaa480172d00a78bc556a0a8550f6f64cb613c60121020e7f64d7dad196fd8fe07d667b50aa2be77c79dd841136d0f0659be3aa8e5ba6ffffffff1ef0dba72077858b5388513263a62678a0bff7bc45dc04164dcafac673d9fdbd000000006b483045022100bb32a2ac921737e958da4e44ba0dcd60e85b5583dab6cbbeb2efc81ca0bf3b410220464415e8a18ee2612fccb034a977c80bc9575adb358aa982b25e3eaed42927bb012102c8a84d4370f37d079896b2f296947ecb9d3812ba074cd38d79f2dc1ef137781affffffff01601800000000000016001429f267742a8cea09dce9853d7c4c4653909f345a00000000',
          value: '6240',
          address: 'bc1q98exwap23n4qnh8fs57hcnzx2wgf7dz6up764t',
          changeIndex: 0, // dummy value
          addressIndex: 10, // dummy value
          sequence: 0xffffffff,
        },
      ],
      outputs: [
        {
          value: '3168',
          address: 'bc1qe5pjgzk9ml6r6xsze8zqz73taehms4e59ttpdf',
          isChange: false,
        },
      ],
    },
  },
  queries: [
    {
      name: 'Initate query',
      data: queryToUint8Array({
        signTxn: {
          initiate: {
            walletId: new Uint8Array([
              199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103,
              233, 62, 110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128,
              26, 3, 187, 121, 64,
            ]),
            derivationPath: [0x80000000 + 44, 0x80000000, 0x80000000],
          },
        },
      }),
    },
    {
      name: 'Send meta',
      data: queryToUint8Array({
        signTxn: {
          meta: {
            version: 2,
            locktime: 0,
            inputCount: 1,
            outputCount: 1,
            sighash: 1,
          },
        },
      }),
    },
    {
      name: 'Input 1',
      data: queryToUint8Array({
        signTxn: {
          input: {
            chunkPayload: {
              chunk: new Uint8Array([
                10, 209, 2, 2, 0, 0, 0, 2, 229, 147, 120, 49, 96, 69, 52, 223,
                224, 19, 249, 166, 169, 131, 174, 109, 107, 216, 83, 244, 47,
                35, 92, 231, 12, 165, 167, 254, 129, 100, 55, 56, 0, 0, 0, 0,
                107, 72, 48, 69, 2, 33, 0, 206, 214, 58, 77, 68, 70, 52, 117,
                218, 204, 117, 45, 192, 166, 246, 123, 137, 46, 180, 137, 78,
                201, 145, 23, 201, 251, 4, 172, 3, 176, 91, 174, 2, 32, 54, 201,
                152, 89, 32, 185, 216, 56, 133, 128, 130, 34, 62, 170, 72, 1,
                114, 208, 10, 120, 188, 85, 106, 10, 133, 80, 246, 246, 76, 182,
                19, 198, 1, 33, 2, 14, 127, 100, 215, 218, 209, 150, 253, 143,
                224, 125, 102, 123, 80, 170, 43, 231, 124, 121, 221, 132, 17,
                54, 208, 240, 101, 155, 227, 170, 142, 91, 166, 255, 255, 255,
                255, 30, 240, 219, 167, 32, 119, 133, 139, 83, 136, 81, 50, 99,
                166, 38, 120, 160, 191, 247, 188, 69, 220, 4, 22, 77, 202, 250,
                198, 115, 217, 253, 189, 0, 0, 0, 0, 107, 72, 48, 69, 2, 33, 0,
                187, 50, 162, 172, 146, 23, 55, 233, 88, 218, 78, 68, 186, 13,
                205, 96, 232, 91, 85, 131, 218, 182, 203, 190, 178, 239, 200,
                28, 160, 191, 59, 65, 2, 32, 70, 68, 21, 232, 161, 142, 226, 97,
                47, 204, 176, 52, 169, 119, 200, 11, 201, 87, 90, 219, 53, 138,
                169, 130, 178, 94, 62, 174, 212, 41, 39, 187, 1, 33, 2, 200,
                168, 77, 67, 112, 243, 125, 7, 152, 150, 178, 242, 150, 148,
                126, 203, 157, 56, 18, 186, 7, 76, 211, 141, 121, 242, 220, 30,
                241, 55, 120, 26, 255, 255, 255, 255, 1, 96, 24, 0, 0, 0, 0, 0,
                0, 22, 0, 20, 41, 242, 103, 116, 42, 140, 234, 9, 220, 233, 133,
                61, 124, 76, 70, 83, 144, 159, 52, 90, 0, 0, 0, 0, 18, 32, 29,
                134, 75, 79, 251, 218, 134, 244, 241, 105, 84, 149, 62, 129, 60,
                161, 54, 5, 101, 40, 46, 108, 56, 127, 2, 100, 205, 161, 118,
                51, 72, 225, 32, 224, 48, 42, 22, 0, 20, 41, 242, 103, 116, 42,
                140, 234, 9, 220, 233, 133, 61, 124, 76, 70, 83, 144, 159, 52,
                90, 48, 255, 255, 255, 255, 15, 64, 10,
              ]),
              chunkIndex: 0,
              totalChunks: 1,
              remainingSize: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Output 1',
      data: queryToUint8Array({
        signTxn: {
          output: {
            scriptPubKey: hexToUint8Array(
              '0014cd03240ac5dff43d1a02c9c4017a2bee6fb85734',
            ),
            value: '3168',
            isChange: false,
          },
        },
      }),
    },
    {
      name: 'Signature request 1',
      data: queryToUint8Array({
        signTxn: {
          signature: { index: 0 },
        },
      }),
    },
  ],
  results: [
    {
      name: 'Confirmation',
      data: new Uint8Array([26, 2, 10, 0]),
      statuses: [
        {
          flowStatus: createFlowStatus(0, 0),
          expectEventCalls: [0],
        },
        {
          flowStatus: createFlowStatus(1, 0),
          expectEventCalls: [1],
        },
      ],
    },
    {
      name: 'Meta Accepted',
      data: resultToUint8Array({
        signTxn: {
          metaAccepted: {},
        },
      }),
    },
    {
      name: 'Input accepted: 1',
      data: resultToUint8Array({
        signTxn: {
          inputAccepted: { chunkAck: { chunkIndex: 0 } },
        },
      }),
    },
    {
      name: 'Output accepted: 1',
      data: resultToUint8Array({
        signTxn: {
          outputAccepted: {},
        },
      }),
    },
    {
      name: 'Signature: 1',
      data: resultToUint8Array({
        signTxn: {
          signature: {
            signature: hexToUint8Array(
              '483045022100d946ce57571ae63f5b1f16aeb759f84736bdb9b364955e8756cc9e25c8f4745b02206ae916c173aaf32c642369c9f196c5fd9cf8b63350cd0c4d5c4b7dbba73b7b740121035f4cf9b856e62a02f5c895094305d7a5370f3fa3f1e625b6c535d4be1fa1d19e',
            ),
          },
        },
      }),
    },
  ],
  mocks: { eventCalls: [[0], [1], [2], [3], [4]] },
  output: {
    signatures: [
      '483045022100d946ce57571ae63f5b1f16aeb759f84736bdb9b364955e8756cc9e25c8f4745b02206ae916c173aaf32c642369c9f196c5fd9cf8b63350cd0c4d5c4b7dbba73b7b740121035f4cf9b856e62a02f5c895094305d7a5370f3fa3f1e625b6c535d4be1fa1d19e',
    ],
    signedTransaction:
      '020000000001011d864b4ffbda86f4f16954953e813ca1360565282e6c387f0264cda1763348e10000000000ffffffff01600c000000000000160014cd03240ac5dff43d1a02c9c4017a2bee6fb8573402483045022100d946ce57571ae63f5b1f16aeb759f84736bdb9b364955e8756cc9e25c8f4745b02206ae916c173aaf32c642369c9f196c5fd9cf8b63350cd0c4d5c4b7dbba73b7b740121035f4cf9b856e62a02f5c895094305d7a5370f3fa3f1e625b6c535d4be1fa1d19e00000000',
  },
};

const withMultipleInputs: ISignTxnTestCase = {
  name: 'With multiple inputs and outputs',
  params: {
    walletId: new Uint8Array([
      199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103, 233, 62,
      110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128, 26, 3, 187, 121,
      64,
    ]),
    derivationPath: [0x80000000 + 44, 0x80000000, 0x80000000],
    txn: {
      locktime: 0,
      hashType: 1,
      inputs: [
        {
          prevIndex: 1,
          prevTxnId:
            'c011cfab883d8729adafc324536b4e94992c410893dbc1ea5fe384d02f3b6340',
          prevTxn:
            '01000000000101fee6b227e3e24bf2e5a4ea1ca6eba722c5eab233832c9c84b4893339ad9294413200000000ffffffff02dcb93400000000001976a9141499db6b8f427c624a644bf9442b9e3ec37f211d88aca9790100000000001600143026421e3930e0243b626d1445fb2d028510c68a024830450221008e2f802e44bdff18531a05ddc5b3788e84ca96b813677296dae224687d25df320220518d296d04cb9b40c338bf83afd07e73e810b90213c875137740dbebcba7af3b0121024aece25573da4ed274ee891341490fe26bd021b63e54e8581fc3ca10085a8fa000000000',
          value: '96681',
          address: 'bc1qxqnyy83exrszgwmzd52yt7edq2z3p352l5jm04',

          changeIndex: 0, // dummy value
          addressIndex: 15, // dummy value
        },
        {
          prevIndex: 4,
          prevTxnId:
            '43294378fe980869bae0d9d27cd10adcdca1d155e4035b4f8d08b1512f5252a4',
          prevTxn:
            '0100000000010364843da25e45a69c95135f5cde3cc7eeccf11814401e197d55e9f3fe5e90d7661100000000ffffffff1f65d1a5680c910c965dfd888c84909dff69dc32b846b81bf5b3aa96ca4a8cca0800000000ffffffff1f65d1a5680c910c965dfd888c84909dff69dc32b846b81bf5b3aa96ca4a8cca0900000000ffffffff36b1b101000000000017a914c02e772dc3fcf4b9e8fe439f4e0a018cdd01dd0b87e313020000000000160014c70030540cd9bd563e58f7f7cabc5df4e19d6654012f0300000000001600146db90e679c18ac9c204d2e6b6ee18e9d025e49f82c66030000000000160014870c47ca1848e4ca2c503c93546cacedc9379cbdec4b040000000000160014cf9c2b2c20a7b32bb97e657cea24ad9eb9cd6ddad8b904000000000017a9148c6d4c1a63b0b7b5724270107e4dfe81bf4f1309875d2c050000000000160014edd81fc7342399f0cfde1e330d70d76d29c3aaa75d2c0500000000001976a9141cfce579f116afc066675878fdc73aea4e0b0a2788acaf2d0500000000001600142b10e0e9f65079ac2694941a8f2352474eeeb31b060d0600000000001976a914605348ec8c1b6f01fdbce5e40b30ee837a07e5c588acaa0d06000000000017a9146fcfdd1044559e159f0c6fab8b8a03c42637b1478716d20700000000001976a9143a8a4a5ca13ffaf17f89b07541e5460f2dcdac6688ac4cb40800000000001976a914147e7200216aa3a5b3df1863e420de36d493c51988ac4cb40800000000001976a914a0067478ae6eea5c18e340c96acd463f0e7db7e788acbdb5080000000000160014f8803023a8f0ffe9de2d67642fc58d9b1fb10057f5b508000000000017a914384b052d88e97eeb56152b044c73402a8c1291f5875aeb0a0000000000160014662addfc46e50ee3eca967750e200094bbf8e8acb61b0d00000000001976a914f83394a4be74357310e80949511bdd090f7fb0e388ac411c0d0000000000160014833dfc8a4c69b4713210c19d1d4c2b0cc2c790f2ac210d000000000017a91499e0013002c60f1d0e4e51cf63951578ca0c4ac8873cd60d0000000000160014452aa71598fafa7c88606c22dd0b60f0c47f2801086f0e000000000017a91454c7c9d7cd18d5038d78ccf29f6fa99409a6c9e787548a11000000000016001445759799d422da97081891489d02f5491962dde3fd9011000000000017a914a38c1cee3ca65eace62369447472f03e4d9e90bf87fdf61100000000001976a9147fe96039668c62d509b7f067969df42b965df5c888acf33014000000000017a914a17148fc7ccc29a1bec403da131dc8f0e639bf628757f7150000000000160014ed3936661227d281e9b01be82a7a0f1e03c69e0fb4fd15000000000017a914f985d1916a77dfe388e57300ee5170584ce373c58736641600000000001600144d045d84fc458c38aea978436be5d7c0a82cc31235bd1700000000001976a91460f0cc1314af7edd5aa54d833cae650fec31531b88ac6b6a1a00000000001976a9148c62ecbd76295f6bca4a72c4ad0ed8101d2c876188ac4cf01b00000000001976a914a82f6fd719921adf81be38e14a18053963dcf08f88ace4d81e000000000016001451709f628198045034dc256ab1944a2ffb97ca562fb22700000000001976a914c3d573009afbb2725a5c963825b4390cf92bb46a88acadbc2700000000001600148a37c7d7e14e4f53261df720b319679b6402179da9012c0000000000160014c9bb1a14f53c1123809928dece81244c7ca6f2ad8a142c000000000017a9143e2c470cff783730b856d53536304fd9ad82caeb8773f73f0000000000160014214ff17077aec7fb60ff9b68c131715a4ed756cb10514200000000001976a9145c1bf5d502d14903c2d9c6c0624a5b3d1846391f88ac46e74a0000000000160014e4fec9c405b91570103b5a86d93b52520203fe497a265800000000001976a914550aff142c9baa27dc961dd4000bced5216b915a88ac2c4c580000000000160014c36ae32737c99bd9201201d69ff74423be18157e4cdb7f000000000017a914d1ef08ba737f60a46997592efc7d02547f4deb8d873dfe7f000000000016001430b28634d347a8edb41c04a36bd67beecae3f844bc10800000000000160014cb02fdcf67edca38c74dac41c57c234adc429eb978158000000000001976a914d9cfb1287761f9be692760526d81f0a60be5014a88ac991b820000000000160014522d45778ab31b779b1a5503967e65ff029ed14a916683000000000016001445306f60bea8ec6e36ad21966d9152293fa18c8c4056a80000000000220020176a2f19c61bd017fc98135b2142e4ccdd8e8f302d394d5d478755ccc5b37efc42c38d01000000001600141083f23d3fa9a53d98b3b38bd53fa9aa810eba9499d5b9010000000017a9141d8c1864a502f9bdba03ddf8c06c41aa8cf7b4bd872be0e3010000000016001486626e44f8483a59a5815e365a7c10ebe508554934fc950200000000160014dfd6b30ee49b22f1a0f81bb614cad44be30ae9ec5f15c202000000001976a91467dd0a4d6580fda597f369b90653be02d02f503488ac04004830450221008c2ed1314e81fc461972aa40ddb7241247a7609b287ef0a726f51233bc2693740220198993f0eabe1535e6ccd5edd6faa42734d44f05f112b46f82cc2c1342e6f07201473044022075b16b266843d9b109bdf547127523a0c2a3908ec5bd9c038fa07fbb64bf925002205ad0bd80e53af9a45fb4ba0f854d37043c3c5934d90c07aa6867ec714a9d00720169522103aa9037fff6c420e8bb99bcec4390524e88ad0270919736c0ba976f4ccf258a2d21035f551eb21bf1f356057284185fcc26d14d314821a16c4782c2ff64d4d88250542102c2f3ff568afbf1bd12125e2d2b4aacc9a925ec79f247d3c520b98b93115a5cea53ae0400483045022100c0bd09959b84def0a525df02d960ccf332d858f900b48f6595695db8abd17a09022060a9bbf733dc2792f9d98b730388c5785adf32865e6b419423753668e1762b8a014730440220508e12d1c2dcba16180a05f2e589520306bb3b83b94d851d552cf0da5f30d9a102204b05047c1b547e3479411d1bc38aa4b281b6308a15d5011d1be6c875f0518e6e0169522102af9e110a047975dda9c8fd7f6a2b56e5bcae0f72e29fce2bd637de925329859921021785f05c393fc2fbb3832685054dc0141731bf4ce12af8c570ffc32a8172ba1821021a4560723742b26634f7cff80b6c1b32e22951ef38331cc30e663830385a1e6653ae0400483045022100b4df1b0b740614692f2f4e51799cede259bccb4ad939b12a4d14cdccc605ed6a0220470eb035fcd9fa358a1ac5e0cb484849bcfa0aa487c14b9e81d60ba58869fb1a01473044022066a0ae89947c8a752598bc75cf0765f66cdad396cd111af4cf788614d05f4ebe022079e14ab7a5abd226993f5689fecabc5afca47550ec6d9383acbb165961f3eacc01695221032f5d297d251d2d17ee970f911ed5e99c2dbe1300fcbe5e59c2b2fdb8fbf6351b21028e0774d826aba58a5a9f3fdfb27e97f8b5ce10f23176ffa9583fa9866f61c86621026035c31064d2175de5da39c69c07c58d3d695f39a2023bb393f1bfc8f14dd63953aeca3d0c00',
          value: '281580',
          address: 'bc1qe7wzktpq57ejhwt7v47w5f9dn6uu6mw6nlhkyr',

          changeIndex: 0, // dummy value
          addressIndex: 54, // dummy value
        },
      ],
      outputs: [
        {
          value: '339259',
          address: '12svq1vtvn2KQJL25rM3FnEnCW4wed6dAo',
          isChange: false,
        },
        {
          value: '33950',
          address: 'bc1qvev2mq3nf4xtfur2d2mdn3q8cw6mwqa2994v38',
          isChange: false,
        },
      ],
    },
  },
  queries: [
    {
      name: 'Initate query',
      data: queryToUint8Array({
        signTxn: {
          initiate: {
            walletId: new Uint8Array([
              199, 89, 252, 26, 32, 135, 183, 211, 90, 220, 38, 17, 160, 103,
              233, 62, 110, 172, 92, 20, 35, 250, 190, 146, 62, 8, 53, 86, 128,
              26, 3, 187, 121, 64,
            ]),
            derivationPath: [0x80000000 + 44, 0x80000000, 0x80000000],
          },
        },
      }),
    },
    {
      name: 'Send meta',
      data: queryToUint8Array({
        signTxn: {
          meta: {
            version: 2,
            locktime: 0,
            inputCount: 2,
            outputCount: 2,
            sighash: 1,
          },
        },
      }),
    },
    {
      name: 'Input 1',
      data: queryToUint8Array({
        signTxn: {
          input: {
            chunkPayload: {
              chunk: new Uint8Array([
                10, 226, 1, 1, 0, 0, 0, 0, 1, 1, 254, 230, 178, 39, 227, 226,
                75, 242, 229, 164, 234, 28, 166, 235, 167, 34, 197, 234, 178,
                51, 131, 44, 156, 132, 180, 137, 51, 57, 173, 146, 148, 65, 50,
                0, 0, 0, 0, 255, 255, 255, 255, 2, 220, 185, 52, 0, 0, 0, 0, 0,
                25, 118, 169, 20, 20, 153, 219, 107, 143, 66, 124, 98, 74, 100,
                75, 249, 68, 43, 158, 62, 195, 127, 33, 29, 136, 172, 169, 121,
                1, 0, 0, 0, 0, 0, 22, 0, 20, 48, 38, 66, 30, 57, 48, 224, 36,
                59, 98, 109, 20, 69, 251, 45, 2, 133, 16, 198, 138, 2, 72, 48,
                69, 2, 33, 0, 142, 47, 128, 46, 68, 189, 255, 24, 83, 26, 5,
                221, 197, 179, 120, 142, 132, 202, 150, 184, 19, 103, 114, 150,
                218, 226, 36, 104, 125, 37, 223, 50, 2, 32, 81, 141, 41, 109, 4,
                203, 155, 64, 195, 56, 191, 131, 175, 208, 126, 115, 232, 16,
                185, 2, 19, 200, 117, 19, 119, 64, 219, 235, 203, 167, 175, 59,
                1, 33, 2, 74, 236, 226, 85, 115, 218, 78, 210, 116, 238, 137,
                19, 65, 73, 15, 226, 107, 208, 33, 182, 62, 84, 232, 88, 31,
                195, 202, 16, 8, 90, 143, 160, 0, 0, 0, 0, 18, 32, 64, 99, 59,
                47, 208, 132, 227, 95, 234, 193, 219, 147, 8, 65, 44, 153, 148,
                78, 107, 83, 36, 195, 175, 173, 41, 135, 61, 136, 171, 207, 17,
                192, 24, 1, 32, 169, 243, 5, 42, 22, 0, 20, 48, 38, 66, 30, 57,
                48, 224, 36, 59, 98, 109, 20, 69, 251, 45, 2, 133, 16, 198, 138,
                48, 255, 255, 255, 255, 15, 64, 15,
              ]),
              chunkIndex: 0,
              totalChunks: 1,
              remainingSize: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Input 2: Chunk 1',
      data: queryToUint8Array({
        signTxn: {
          input: {
            chunkPayload: {
              chunk: new Uint8Array([
                10, 205, 20, 1, 0, 0, 0, 0, 1, 3, 100, 132, 61, 162, 94, 69,
                166, 156, 149, 19, 95, 92, 222, 60, 199, 238, 204, 241, 24, 20,
                64, 30, 25, 125, 85, 233, 243, 254, 94, 144, 215, 102, 17, 0, 0,
                0, 0, 255, 255, 255, 255, 31, 101, 209, 165, 104, 12, 145, 12,
                150, 93, 253, 136, 140, 132, 144, 157, 255, 105, 220, 50, 184,
                70, 184, 27, 245, 179, 170, 150, 202, 74, 140, 202, 8, 0, 0, 0,
                0, 255, 255, 255, 255, 31, 101, 209, 165, 104, 12, 145, 12, 150,
                93, 253, 136, 140, 132, 144, 157, 255, 105, 220, 50, 184, 70,
                184, 27, 245, 179, 170, 150, 202, 74, 140, 202, 9, 0, 0, 0, 0,
                255, 255, 255, 255, 54, 177, 177, 1, 0, 0, 0, 0, 0, 23, 169, 20,
                192, 46, 119, 45, 195, 252, 244, 185, 232, 254, 67, 159, 78, 10,
                1, 140, 221, 1, 221, 11, 135, 227, 19, 2, 0, 0, 0, 0, 0, 22, 0,
                20, 199, 0, 48, 84, 12, 217, 189, 86, 62, 88, 247, 247, 202,
                188, 93, 244, 225, 157, 102, 84, 1, 47, 3, 0, 0, 0, 0, 0, 22, 0,
                20, 109, 185, 14, 103, 156, 24, 172, 156, 32, 77, 46, 107, 110,
                225, 142, 157, 2, 94, 73, 248, 44, 102, 3, 0, 0, 0, 0, 0, 22, 0,
                20, 135, 12, 71, 202, 24, 72, 228, 202, 44, 80, 60, 147, 84,
                108, 172, 237, 201, 55, 156, 189, 236, 75, 4, 0, 0, 0, 0, 0, 22,
                0, 20, 207, 156, 43, 44, 32, 167, 179, 43, 185, 126, 101, 124,
                234, 36, 173, 158, 185, 205, 109, 218, 216, 185, 4, 0, 0, 0, 0,
                0, 23, 169, 20, 140, 109, 76, 26, 99, 176, 183, 181, 114, 66,
                112, 16, 126, 77, 254, 129, 191, 79, 19, 9, 135, 93, 44, 5, 0,
                0, 0, 0, 0, 22, 0, 20, 237, 216, 31, 199, 52, 35, 153, 240, 207,
                222, 30, 51, 13, 112, 215, 109, 41, 195, 170, 167, 93, 44, 5, 0,
                0, 0, 0, 0, 25, 118, 169, 20, 28, 252, 229, 121, 241, 22, 175,
                192, 102, 103, 88, 120, 253, 199, 58, 234, 78, 11, 10, 39, 136,
                172, 175, 45, 5, 0, 0, 0, 0, 0, 22, 0, 20, 43, 16, 224, 233,
                246, 80, 121, 172, 38, 148, 148, 26, 143, 35, 82, 71, 78, 238,
                179, 27, 6, 13, 6, 0, 0, 0, 0, 0, 25, 118, 169, 20, 96, 83, 72,
                236, 140, 27, 111, 1, 253, 188, 229, 228, 11, 48, 238, 131, 122,
                7, 229, 197, 136, 172, 170, 13, 6, 0, 0, 0, 0, 0, 23, 169, 20,
                111, 207, 221, 16, 68, 85, 158, 21, 159, 12, 111, 171, 139, 138,
                3, 196, 38, 55, 177, 71, 135, 22, 210, 7, 0, 0, 0, 0, 0, 25,
                118, 169, 20, 58, 138, 74, 92, 161, 63, 250, 241, 127, 137, 176,
                117, 65, 229, 70, 15, 45, 205, 172, 102, 136, 172, 76, 180, 8,
                0, 0, 0, 0, 0, 25, 118, 169, 20, 20, 126, 114, 0, 33, 106, 163,
                165, 179, 223, 24, 99, 228, 32, 222, 54, 212, 147, 197, 25, 136,
                172, 76, 180, 8, 0, 0, 0, 0, 0, 25, 118, 169, 20, 160, 6, 116,
                120, 174, 110, 234, 92, 24, 227, 64, 201, 106, 205, 70, 63, 14,
                125, 183, 231, 136, 172, 189, 181, 8, 0, 0, 0, 0, 0, 22, 0, 20,
                248, 128, 48, 35, 168, 240, 255, 233, 222, 45, 103, 100, 47,
                197, 141, 155, 31, 177, 0, 87, 245, 181, 8, 0, 0, 0, 0, 0, 23,
                169, 20, 56, 75, 5, 45, 136, 233, 126, 235, 86, 21, 43, 4, 76,
                115, 64, 42, 140, 18, 145, 245, 135, 90, 235, 10, 0, 0, 0, 0, 0,
                22, 0, 20, 102, 42, 221, 252, 70, 229, 14, 227, 236, 169, 103,
                117, 14, 32, 0, 148, 187, 248, 232, 172, 182, 27, 13, 0, 0, 0,
                0, 0, 25, 118, 169, 20, 248, 51, 148, 164, 190, 116, 53, 115,
                16, 232, 9, 73, 81, 27, 221, 9, 15, 127, 176, 227, 136, 172, 65,
                28, 13, 0, 0, 0, 0, 0, 22, 0, 20, 131, 61, 252, 138, 76, 105,
                180, 113, 50, 16, 193, 157, 29, 76, 43, 12, 194, 199, 144, 242,
                172, 33, 13, 0, 0, 0, 0, 0, 23, 169, 20, 153, 224, 1, 48, 2,
                198, 15, 29, 14, 78, 81, 207, 99, 149, 21, 120, 202, 12, 74,
                200, 135, 60, 214, 13, 0, 0, 0, 0, 0, 22, 0, 20, 69, 42, 167,
                21, 152, 250, 250, 124, 136, 96, 108, 34, 221, 11, 96, 240, 196,
                127, 40, 1, 8, 111, 14, 0, 0, 0, 0, 0, 23, 169, 20, 84, 199,
                201, 215, 205, 24, 213, 3, 141, 120, 204, 242, 159, 111, 169,
                148, 9, 166, 201, 231, 135, 84, 138, 17, 0, 0, 0, 0, 0, 22, 0,
                20, 69, 117, 151, 153, 212, 34, 218, 151, 8, 24, 145, 72, 157,
                2, 245, 73, 25, 98, 221, 227, 253, 144, 17, 0, 0, 0, 0, 0, 23,
                169, 20, 163, 140, 28, 238, 60, 166, 94, 172, 230, 35, 105, 68,
                116, 114, 240, 62, 77, 158, 144, 191, 135, 253, 246, 17, 0, 0,
                0, 0, 0, 25, 118, 169, 20, 127, 233, 96, 57, 102, 140, 98, 213,
                9, 183, 240, 103, 150, 157, 244, 43, 150, 93, 245, 200, 136,
                172, 243, 48, 20, 0, 0, 0, 0, 0, 23, 169, 20, 161, 113, 72, 252,
                124, 204, 41, 161, 190, 196, 3, 218, 19, 29, 200, 240, 230, 57,
                191, 98, 135, 87, 247, 21, 0, 0, 0, 0, 0, 22, 0, 20, 237, 57,
                54, 102, 18, 39, 210, 129, 233, 176, 27, 232, 42, 122, 15, 30,
                3, 198, 158, 15, 180, 253, 21, 0, 0, 0, 0, 0, 23, 169, 20, 249,
                133, 209, 145, 106, 119, 223, 227, 136, 229, 115, 0, 238, 81,
                112, 88, 76, 227, 115, 197, 135, 54, 100, 22, 0, 0, 0, 0, 0, 22,
                0, 20, 77, 4, 93, 132, 252, 69, 140, 56, 174, 169, 120, 67, 107,
                229, 215, 192, 168, 44, 195, 18, 53, 189, 23, 0, 0, 0, 0, 0, 25,
                118, 169, 20, 96, 240, 204, 19, 20, 175, 126, 221, 90, 165, 77,
                131, 60, 174, 101, 15, 236, 49, 83, 27, 136, 172, 107, 106, 26,
                0, 0, 0, 0, 0, 25, 118, 169, 20, 140, 98, 236, 189, 118, 41, 95,
                107, 202, 74, 114, 196, 173, 14, 216, 16, 29, 44, 135, 97, 136,
                172, 76, 240, 27, 0, 0, 0, 0, 0, 25, 118, 169, 20, 168, 47, 111,
                215, 25, 146, 26, 223, 129, 190, 56, 225, 74, 24, 5, 57, 99,
                220, 240, 143, 136, 172, 228, 216, 30, 0, 0, 0, 0, 0, 22, 0, 20,
                81, 112, 159, 98, 129, 152, 4, 80, 52, 220, 37, 106, 177, 148,
                74, 47, 251, 151, 202, 86, 47, 178, 39, 0, 0, 0, 0, 0, 25, 118,
                169, 20, 195, 213, 115, 0, 154, 251, 178, 114, 90, 92, 150, 56,
                37, 180, 57, 12, 249, 43, 180, 106, 136, 172, 173, 188, 39, 0,
                0, 0, 0, 0, 22, 0, 20, 138, 55, 199, 215, 225, 78, 79, 83, 38,
                29, 247, 32, 179, 25, 103, 155, 100, 2, 23, 157, 169, 1, 44, 0,
                0, 0, 0, 0, 22, 0, 20, 201, 187, 26, 20, 245, 60, 17, 35, 128,
                153, 40, 222, 206, 129, 36, 76, 124, 166, 242, 173, 138, 20, 44,
                0, 0, 0, 0, 0, 23, 169, 20, 62, 44, 71, 12, 255, 120, 55, 48,
                184, 86, 213, 53, 54, 48, 79, 217, 173, 130, 202, 235, 135, 115,
                247, 63, 0, 0, 0, 0, 0, 22, 0, 20, 33, 79, 241, 112, 119, 174,
                199, 251, 96, 255, 155, 104, 193, 49, 113, 90, 78, 215, 86, 203,
                16, 81, 66, 0, 0, 0, 0, 0, 25, 118, 169, 20, 92, 27, 245, 213,
                2, 209, 73, 3, 194, 217, 198, 192, 98, 74, 91, 61, 24, 70, 57,
                31, 136, 172, 70, 231, 74, 0, 0, 0, 0, 0, 22, 0, 20, 228, 254,
                201, 196, 5, 185, 21, 112, 16, 59, 90, 134, 217, 59, 82, 82, 2,
                3, 254, 73, 122, 38, 88, 0, 0, 0, 0, 0, 25, 118, 169, 20, 85,
                10, 255, 20, 44, 155, 170, 39, 220, 150, 29, 212, 0, 11, 206,
                213, 33, 107, 145, 90, 136, 172, 44, 76, 88, 0, 0, 0, 0, 0, 22,
                0, 20, 195, 106, 227, 39, 55, 201, 155, 217, 32, 18, 1, 214,
                159, 247, 68, 35, 190, 24, 21, 126, 76, 219, 127, 0, 0, 0, 0, 0,
                23, 169, 20, 209, 239, 8, 186, 115, 127, 96, 164, 105, 151, 89,
                46, 252, 125, 2, 84, 127, 77, 235, 141, 135, 61, 254, 127, 0, 0,
                0, 0, 0, 22, 0, 20, 48, 178, 134, 52, 211, 71, 168, 237, 180,
                28, 4, 163, 107, 214, 123, 238, 202, 227, 248, 68, 188, 16, 128,
                0, 0, 0, 0, 0, 22, 0, 20, 203, 2, 253, 207, 103, 237, 202, 56,
                199, 77, 172, 65, 197, 124, 35, 74, 220, 66, 158, 185, 120, 21,
                128, 0, 0, 0, 0, 0, 25, 118, 169, 20, 217, 207, 177, 40, 119,
                97, 249, 190, 105, 39, 96, 82, 109, 129, 240, 166, 11, 229, 1,
                74, 136, 172, 153, 27, 130, 0, 0, 0, 0, 0, 22, 0, 20, 82, 45,
                69, 119, 138, 179, 27, 119, 155, 26, 85, 3, 150, 126, 101, 255,
                2, 158, 209, 74, 145, 102, 131, 0, 0, 0, 0, 0, 22, 0, 20, 69,
                48, 111, 96, 190, 168, 236, 110, 54, 173, 33, 150, 109, 145, 82,
                41, 63, 161, 140, 140, 64, 86, 168, 0, 0, 0, 0, 0, 34, 0, 32,
                23, 106, 47, 25, 198, 27, 208, 23, 252, 152, 19, 91, 33, 66,
                228, 204, 221, 142, 143, 48, 45, 57, 77, 93, 71, 135, 85, 204,
                197, 179, 126, 252, 66, 195, 141, 1, 0, 0, 0, 0, 22, 0, 20, 16,
                131, 242, 61, 63, 169, 165, 61, 152, 179, 179, 139, 213, 63,
                169, 170, 129, 14, 186, 148, 153, 213, 185, 1, 0, 0, 0, 0, 23,
                169, 20, 29, 140, 24, 100, 165, 2, 249, 189, 186, 3, 221, 248,
                192, 108, 65, 170, 140, 247, 180, 189, 135, 43, 224, 227, 1, 0,
                0, 0, 0, 22, 0, 20, 134, 98, 110, 68, 248, 72, 58, 89, 165, 129,
                94, 54, 90, 124, 16, 235, 229, 8, 85, 73, 52, 252, 149, 2, 0, 0,
                0, 0, 22, 0, 20, 223, 214, 179, 14, 228, 155, 34, 241, 160, 248,
                27, 182, 20, 202, 212, 75, 227, 10, 233, 236, 95, 21, 194, 2, 0,
                0, 0, 0, 25, 118, 169, 20, 103, 221, 10, 77, 101, 128, 253, 165,
                151, 243, 105, 185, 6, 83, 190, 2, 208, 47, 80, 52, 136, 172, 4,
                0, 72, 48, 69, 2, 33, 0, 140, 46, 209, 49, 78, 129, 252, 70, 25,
                114, 170, 64, 221, 183, 36, 18, 71, 167, 96, 155, 40, 126, 240,
                167, 38, 245, 18, 51, 188, 38, 147, 116, 2, 32, 25, 137, 147,
                240, 234, 190, 21, 53, 230, 204, 213, 237, 214, 250, 164, 39,
                52, 212, 79, 5, 241, 18, 180, 111, 130, 204, 44, 19, 66, 230,
                240, 114, 1, 71, 48, 68, 2, 32, 117, 177, 107, 38, 104, 67, 217,
                177, 9, 189, 245, 71, 18, 117, 35, 160, 194, 163, 144, 142, 197,
                189, 156, 3, 143, 160, 127, 187, 100, 191, 146, 80, 2, 32, 90,
                208, 189, 128, 229, 58, 249, 164, 95, 180, 186, 15, 133, 77, 55,
                4, 60, 60, 89, 52, 217, 12, 7, 170, 104, 103, 236, 113, 74, 157,
                0, 114, 1, 105, 82, 33, 3, 170, 144, 55, 255, 246, 196, 32, 232,
                187, 153, 188, 236, 67, 144, 82, 78, 136, 173, 2, 112,
              ]),
              chunkIndex: 0,
              totalChunks: 2,
              remainingSize: 664,
            },
          },
        },
      }),
    },
    {
      name: 'Input 2: Chunk 2',
      data: queryToUint8Array({
        signTxn: {
          input: {
            chunkPayload: {
              chunk: new Uint8Array([
                145, 151, 54, 192, 186, 151, 111, 76, 207, 37, 138, 45, 33, 3,
                95, 85, 30, 178, 27, 241, 243, 86, 5, 114, 132, 24, 95, 204, 38,
                209, 77, 49, 72, 33, 161, 108, 71, 130, 194, 255, 100, 212, 216,
                130, 80, 84, 33, 2, 194, 243, 255, 86, 138, 251, 241, 189, 18,
                18, 94, 45, 43, 74, 172, 201, 169, 37, 236, 121, 242, 71, 211,
                197, 32, 185, 139, 147, 17, 90, 92, 234, 83, 174, 4, 0, 72, 48,
                69, 2, 33, 0, 192, 189, 9, 149, 155, 132, 222, 240, 165, 37,
                223, 2, 217, 96, 204, 243, 50, 216, 88, 249, 0, 180, 143, 101,
                149, 105, 93, 184, 171, 209, 122, 9, 2, 32, 96, 169, 187, 247,
                51, 220, 39, 146, 249, 217, 139, 115, 3, 136, 197, 120, 90, 223,
                50, 134, 94, 107, 65, 148, 35, 117, 54, 104, 225, 118, 43, 138,
                1, 71, 48, 68, 2, 32, 80, 142, 18, 209, 194, 220, 186, 22, 24,
                10, 5, 242, 229, 137, 82, 3, 6, 187, 59, 131, 185, 77, 133, 29,
                85, 44, 240, 218, 95, 48, 217, 161, 2, 32, 75, 5, 4, 124, 27,
                84, 126, 52, 121, 65, 29, 27, 195, 138, 164, 178, 129, 182, 48,
                138, 21, 213, 1, 29, 27, 230, 200, 117, 240, 81, 142, 110, 1,
                105, 82, 33, 2, 175, 158, 17, 10, 4, 121, 117, 221, 169, 200,
                253, 127, 106, 43, 86, 229, 188, 174, 15, 114, 226, 159, 206,
                43, 214, 55, 222, 146, 83, 41, 133, 153, 33, 2, 23, 133, 240,
                92, 57, 63, 194, 251, 179, 131, 38, 133, 5, 77, 192, 20, 23, 49,
                191, 76, 225, 42, 248, 197, 112, 255, 195, 42, 129, 114, 186,
                24, 33, 2, 26, 69, 96, 114, 55, 66, 178, 102, 52, 247, 207, 248,
                11, 108, 27, 50, 226, 41, 81, 239, 56, 51, 28, 195, 14, 102, 56,
                48, 56, 90, 30, 102, 83, 174, 4, 0, 72, 48, 69, 2, 33, 0, 180,
                223, 27, 11, 116, 6, 20, 105, 47, 47, 78, 81, 121, 156, 237,
                226, 89, 188, 203, 74, 217, 57, 177, 42, 77, 20, 205, 204, 198,
                5, 237, 106, 2, 32, 71, 14, 176, 53, 252, 217, 250, 53, 138, 26,
                197, 224, 203, 72, 72, 73, 188, 250, 10, 164, 135, 193, 75, 158,
                129, 214, 11, 165, 136, 105, 251, 26, 1, 71, 48, 68, 2, 32, 102,
                160, 174, 137, 148, 124, 138, 117, 37, 152, 188, 117, 207, 7,
                101, 246, 108, 218, 211, 150, 205, 17, 26, 244, 207, 120, 134,
                20, 208, 95, 78, 190, 2, 32, 121, 225, 74, 183, 165, 171, 210,
                38, 153, 63, 86, 137, 254, 202, 188, 90, 252, 164, 117, 80, 236,
                109, 147, 131, 172, 187, 22, 89, 97, 243, 234, 204, 1, 105, 82,
                33, 3, 47, 93, 41, 125, 37, 29, 45, 23, 238, 151, 15, 145, 30,
                213, 233, 156, 45, 190, 19, 0, 252, 190, 94, 89, 194, 178, 253,
                184, 251, 246, 53, 27, 33, 2, 142, 7, 116, 216, 38, 171, 165,
                138, 90, 159, 63, 223, 178, 126, 151, 248, 181, 206, 16, 242,
                49, 118, 255, 169, 88, 63, 169, 134, 111, 97, 200, 102, 33, 2,
                96, 53, 195, 16, 100, 210, 23, 93, 229, 218, 57, 198, 156, 7,
                197, 141, 61, 105, 95, 57, 162, 2, 59, 179, 147, 241, 191, 200,
                241, 77, 214, 57, 83, 174, 202, 61, 12, 0, 18, 32, 164, 82, 82,
                47, 81, 177, 8, 141, 79, 91, 3, 228, 85, 209, 161, 220, 220, 10,
                209, 124, 210, 217, 224, 186, 105, 8, 152, 254, 120, 67, 41, 67,
                24, 4, 32, 236, 151, 17, 42, 22, 0, 20, 207, 156, 43, 44, 32,
                167, 179, 43, 185, 126, 101, 124, 234, 36, 173, 158, 185, 205,
                109, 218, 48, 255, 255, 255, 255, 15, 64, 54,
              ]),
              chunkIndex: 1,
              totalChunks: 2,
              remainingSize: 0,
            },
          },
        },
      }),
    },
    {
      name: 'Output 1',
      data: queryToUint8Array({
        signTxn: {
          output: {
            scriptPubKey: hexToUint8Array(
              '76a9141499db6b8f427c624a644bf9442b9e3ec37f211d88ac',
            ),
            value: '339259',
            isChange: false,
          },
        },
      }),
    },
    {
      name: 'Output 2',
      data: queryToUint8Array({
        signTxn: {
          output: {
            scriptPubKey: hexToUint8Array(
              '00146658ad82334d4cb4f06a6ab6d9c407c3b5b703aa',
            ),
            value: '33950',
            isChange: false,
          },
        },
      }),
    },
    {
      name: 'Signature request 1',
      data: queryToUint8Array({
        signTxn: {
          signature: { index: 0 },
        },
      }),
    },
    {
      name: 'Signature request 2',
      data: queryToUint8Array({
        signTxn: {
          signature: { index: 1 },
        },
      }),
    },
  ],
  results: [
    {
      name: 'Confirmation',
      data: new Uint8Array([26, 2, 10, 0]),
      statuses: [
        {
          flowStatus: createFlowStatus(0, 0),
          expectEventCalls: [0],
        },
        {
          flowStatus: createFlowStatus(1, 0),
          expectEventCalls: [1],
        },
      ],
    },
    {
      name: 'Meta Accepted',
      data: resultToUint8Array({
        signTxn: {
          metaAccepted: {},
        },
      }),
    },
    {
      name: 'Input request: 1',
      data: resultToUint8Array({
        signTxn: {
          inputAccepted: { chunkAck: { chunkIndex: 0 } },
        },
      }),
    },
    {
      name: 'Input request: 2: Chunk 1',
      data: resultToUint8Array({
        signTxn: {
          inputAccepted: { chunkAck: { chunkIndex: 0 } },
        },
      }),
    },
    {
      name: 'Input request: 2: Chunk 2',
      data: resultToUint8Array({
        signTxn: {
          inputAccepted: { chunkAck: { chunkIndex: 1 } },
        },
      }),
    },
    {
      name: 'Output request: 1',
      data: resultToUint8Array({
        signTxn: {
          outputAccepted: {},
        },
      }),
    },
    {
      name: 'Output request: 2',
      data: resultToUint8Array({
        signTxn: {
          outputAccepted: {},
        },
      }),
    },
    {
      name: 'Signature: 1',
      data: resultToUint8Array({
        signTxn: {
          signature: {
            signature: hexToUint8Array(
              '483045022100e8c05ea1602c7b8e086cf17429415ccfea73952bd2614ded3a8196e42090ccdb02207ea39d215d5f1fa0d2bfc17b912d29ef2116af2c61a7bb53755fb6dbfe6836ed012103828943e8e6bbbbe6848f547c2e3a51236d4fa524fcd67837164ce7c1f0311dd7',
            ),
          },
        },
      }),
    },
    {
      name: 'Signature: 2',
      data: resultToUint8Array({
        signTxn: {
          signature: {
            signature: hexToUint8Array(
              '47304402202069a87c5082e689140721b58ca4c0b81496f6e18095a992c3abcc96b6745a0602202af96658219ce427853923011d9ea67e2a74b78a6cdc58ce64da35bba49becea0121024aece25573da4ed274ee891341490fe26bd021b63e54e8581fc3ca10085a8fa0',
            ),
          },
        },
      }),
    },
  ],
  mocks: { eventCalls: [[0], [1], [2], [3], [4]] },
  output: {
    signatures: [
      '483045022100e8c05ea1602c7b8e086cf17429415ccfea73952bd2614ded3a8196e42090ccdb02207ea39d215d5f1fa0d2bfc17b912d29ef2116af2c61a7bb53755fb6dbfe6836ed012103828943e8e6bbbbe6848f547c2e3a51236d4fa524fcd67837164ce7c1f0311dd7',
      '47304402202069a87c5082e689140721b58ca4c0b81496f6e18095a992c3abcc96b6745a0602202af96658219ce427853923011d9ea67e2a74b78a6cdc58ce64da35bba49becea0121024aece25573da4ed274ee891341490fe26bd021b63e54e8581fc3ca10085a8fa0',
    ],
    // modified version from 1 to 2 for passing the test
    signedTransaction:
      '0200000000010240633b2fd084e35feac1db9308412c99944e6b5324c3afad29873d88abcf11c00100000000ffffffffa452522f51b1088d4f5b03e455d1a1dcdc0ad17cd2d9e0ba690898fe784329430400000000ffffffff023b2d0500000000001976a9141499db6b8f427c624a644bf9442b9e3ec37f211d88ac9e840000000000001600146658ad82334d4cb4f06a6ab6d9c407c3b5b703aa02483045022100e8c05ea1602c7b8e086cf17429415ccfea73952bd2614ded3a8196e42090ccdb02207ea39d215d5f1fa0d2bfc17b912d29ef2116af2c61a7bb53755fb6dbfe6836ed012103828943e8e6bbbbe6848f547c2e3a51236d4fa524fcd67837164ce7c1f0311dd70247304402202069a87c5082e689140721b58ca4c0b81496f6e18095a992c3abcc96b6745a0602202af96658219ce427853923011d9ea67e2a74b78a6cdc58ce64da35bba49becea0121024aece25573da4ed274ee891341490fe26bd021b63e54e8581fc3ca10085a8fa000000000',
  },
};

const valid: ISignTxnTestCase[] = [withOneInput, withMultipleInputs];

export default valid;
